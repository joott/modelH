(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46538,       1198]
NotebookOptionsPosition[     43510,       1141]
NotebookOutlinePosition[     43903,       1157]
CellTagsIndexPosition[     43860,       1154]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"nn", "=", "5"}]], "Input",
 CellChangeTimes->{{3.908489429384379*^9, 3.9084895177718573`*^9}, {
  3.908489553036269*^9, 3.908489557582171*^9}, {3.9084900553987637`*^9, 
  3.908490062321321*^9}, {3.9084903875782948`*^9, 3.908490405153502*^9}, {
  3.90852985475035*^9, 3.908529855160644*^9}, {3.90853107851468*^9, 
  3.9085310791363363`*^9}, {3.908544433706362*^9, 3.908544434114284*^9}, {
  3.908545105385932*^9, 3.908545105772149*^9}, {3.908548140359901*^9, 
  3.908548140861372*^9}, {3.9085592280024567`*^9, 3.908559228274555*^9}, {
  3.908559341624614*^9, 3.908559341812302*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"00a18cbb-b83a-45f5-be50-52b98b5e24a7"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.908490063451289*^9, 3.908490405838119*^9, 
  3.908529855423788*^9, 3.908531079447053*^9, 3.908544434754521*^9, 
  3.9085451061622458`*^9, 3.908548141304132*^9, 3.908548279256681*^9, 
  3.908548413345043*^9, 3.9085592286695213`*^9, 3.908559342338484*^9, 
  3.908559449167658*^9},
 CellLabel->
  "Out[172]=",ExpressionUUID->"3a67b46b-9bba-491f-b778-56341db0b9bc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"del", "[", 
   RowBox[{"expr_", ",", "1"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"DifferenceDelta", "[", 
      RowBox[{"expr", ",", "i"}], "]"}], "+", 
     RowBox[{"DifferenceDelta", "[", 
      RowBox[{
       RowBox[{"expr", "/.", 
        RowBox[{"i", "->", 
         RowBox[{"i", "-", "1"}]}]}], ",", "i"}], "]"}]}], ")"}], "/", 
   "2"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"del", "[", 
   RowBox[{"expr_", ",", "2"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"DifferenceDelta", "[", 
      RowBox[{"expr", ",", "j"}], "]"}], "+", 
     RowBox[{"DifferenceDelta", "[", 
      RowBox[{
       RowBox[{"expr", "/.", 
        RowBox[{"j", "->", 
         RowBox[{"j", "-", "1"}]}]}], ",", "j"}], "]"}]}], ")"}], "/", 
   "2"}]}]}], "Input",
 CellLabel->
  "In[173]:=",ExpressionUUID->"f2a3c3e1-83fc-40eb-b54b-efde4add3ac0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"d\[Pi]_\[Mu]", "/", "dt"}], "*)"}]], "Input",
 CellChangeTimes->{{3.908490432341393*^9, 3.9084904468983*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"45f6a5d4-3516-41fa-83c1-6ab6f6778175"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"del", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}], 
  RowBox[{"del", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.908533929086314*^9, 3.9085339352018147`*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"bcbe3be1-ea50-4f1f-bb9f-a643fa13f755"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"\[Phi]", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "+", "i"}], ",", "j"}], "]"}]}], "+", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{
       RowBox[{"1", "+", "i"}], ",", "j"}], "]"}]}], ")"}], "2"]}]], "Output",\

 CellChangeTimes->{3.908533935611847*^9, 3.908544437171174*^9, 
  3.9085451085761623`*^9, 3.9085481437854548`*^9, 3.908548282094632*^9, 
  3.908548413630123*^9, 3.908559231448723*^9, 3.908559449294982*^9},
 CellLabel->
  "Out[176]=",ExpressionUUID->"f352d340-1f96-44db-982a-a12aeafc59a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"del", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}], " ", 
    RowBox[{"del", "[", 
     RowBox[{
      RowBox[{"del", "[", 
       RowBox[{
        RowBox[{"\[Phi]", "[", 
         RowBox[{"i", ",", "j"}], "]"}], ",", "\[Mu]"}], "]"}], ",", "1"}], 
     "]"}]}], "/.", 
   RowBox[{"\[Mu]", "->", "1"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.9085338655091743`*^9, 3.908533894962496*^9}, {
  3.9085339800460987`*^9, 3.908533986372439*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"199d784e-e5f6-47e2-a3de-aa9f199ee794"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "+", "i"}], ",", "j"}], "]"}], "-", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"1", "+", "i"}], ",", "j"}], "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "+", "i"}], ",", "j"}], "]"}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}], "+", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"2", "+", "i"}], ",", "j"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.908533860580617*^9, 3.908533895479216*^9}, 
   3.908533986968225*^9, 3.908544439264347*^9, 3.908545109436225*^9, 
   3.908548144679263*^9, 3.908548282952058*^9, 3.9085484136788807`*^9, 
   3.9085592323883038`*^9, 3.908559449350553*^9},
 CellLabel->
  "Out[177]=",ExpressionUUID->"c4122b34-a387-43db-8854-54bee0ae2aae"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"d\[Pi]", "[", 
   RowBox[{"i_", ",", "j_", ",", "\[Mu]_"}], "]"}], ":=", 
  RowBox[{
   StyleBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"del", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Pi]", "[", 
           RowBox[{"i", ",", "j", ",", "\[Mu]"}], "]"}], 
          RowBox[{"\[Pi]", "[", 
           RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], ",", "1"}], "]"}], "+", 
       RowBox[{"del", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Pi]", "[", 
           RowBox[{"i", ",", "j", ",", "\[Mu]"}], "]"}], 
          RowBox[{"\[Pi]", "[", 
           RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], ",", "2"}], "]"}]}], 
      ")"}], " ", "/", "2"}],
    Background->RGBColor[0.9, 1, 1]], 
   StyleBox["+",
    Background->RGBColor[0.9, 1, 1]], 
   StyleBox[" ",
    Background->RGBColor[0.9, 1, 1]], 
   StyleBox[
    RowBox[{
     RowBox[{"\[Pi]", "[", 
      RowBox[{"i", ",", "j", ",", "1"}], "]"}], " ", 
     RowBox[{
      RowBox[{"del", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "[", 
         RowBox[{"i", ",", "j", ",", "\[Mu]"}], "]"}], ",", "1"}], "]"}], "/",
       "2"}]}],
    Background->RGBColor[0.9, 1, 1]], 
   StyleBox["+",
    Background->RGBColor[0.9, 1, 1]], 
   StyleBox[
    RowBox[{
     RowBox[{"\[Pi]", "[", 
      RowBox[{"i", ",", "j", ",", "2"}], "]"}], " ", 
     RowBox[{
      RowBox[{"del", "[", 
       RowBox[{
        RowBox[{"\[Pi]", "[", 
         RowBox[{"i", ",", "j", ",", "\[Mu]"}], "]"}], ",", "2"}], "]"}], "/",
       "2"}]}],
    Background->RGBColor[0.9, 1, 1]], 
   StyleBox["+",
    Background->RGBColor[0.9, 1, 1]], 
   RowBox[{
    StyleBox[
     StyleBox[
      RowBox[{"(", "*"}]],
     Background->RGBColor[0.9, 1, 1]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"del", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "\[Mu]"}], "]"}], 
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}]}], ",", "1"}], 
        "]"}], "+", 
       RowBox[{"del", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "\[Mu]"}], "]"}], 
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "2"}], "]"}]}], ",", "2"}], 
        "]"}]}], ")"}], " ", "\[Gamma]"}], "*)"}], 
   RowBox[{
    RowBox[{"+", " ", 
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"del", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}], " ", 
         RowBox[{"del", "[", 
          RowBox[{
           RowBox[{"del", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", "\[Mu]"}], "]"}], ",", 
           "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"del", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", "2"}], "]"}], " ", 
         RowBox[{"del", "[", 
          RowBox[{
           RowBox[{"del", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", 
              RowBox[{"i", ",", "j"}], "]"}], ",", "\[Mu]"}], "]"}], ",", 
           "2"}], "]"}]}]}], "*)"}], " ", 
      RowBox[{"+", " ", 
       RowBox[{
        RowBox[{"del", "[", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"i", ",", "j"}], "]"}], ",", "\[Mu]"}], "]"}], 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"del", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}], ",", "1"}], 
           "]"}], "+", 
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"del", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ",", "2"}], "]"}], ",", "2"}], 
           "]"}]}], ")"}]}]}], ")"}]}], "\[Delta]"}]}]}]], "Input",
 CellChangeTimes->{{3.9085287818542223`*^9, 3.908528830052598*^9}, {
   3.908528879757885*^9, 3.9085289608799467`*^9}, {3.908529024760336*^9, 
   3.908529027590397*^9}, {3.908530015431698*^9, 3.908530021802247*^9}, {
   3.908530063861421*^9, 3.908530144652285*^9}, {3.908530260414188*^9, 
   3.908530268063298*^9}, {3.908530358239923*^9, 3.908530359745469*^9}, {
   3.908534041062675*^9, 3.908534047757464*^9}, 3.908534086415763*^9, {
   3.908557564620916*^9, 3.9085575715169563`*^9}, {3.9085578877691383`*^9, 
   3.908557920722393*^9}, {3.9085593534562607`*^9, 3.908559430020784*^9}, {
   3.908559564812245*^9, 3.908559571850992*^9}, 3.908561001327112*^9, {
   3.908561156168099*^9, 3.9085611662059507`*^9}, {3.9085612385803967`*^9, 
   3.9085612442655687`*^9}, 3.908561426792406*^9},
 CellLabel->
  "In[298]:=",ExpressionUUID->"d31b926c-3ab9-4e5f-91bd-cd4088b339cb"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9084904521025133`*^9, 3.908490458391427*^9}, 
   3.9085575923717747`*^9},
 CellLabel->
  "In[180]:=",ExpressionUUID->"cdc4df2a-145b-4778-bea8-35e81442c140"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"del", "[", 
    RowBox[{
     RowBox[{"del", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}], ",", "1"}], "]"}], 
   "+", 
   RowBox[{"del", "[", 
    RowBox[{
     RowBox[{"del", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", "2"}], "]"}], ",", "2"}], 
    "]"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.908559899967746*^9, 3.908559901056107*^9}},
 CellLabel->
  "In[287]:=",ExpressionUUID->"179c6bbc-3f6c-4e49-9b48-e0031092dfe8"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], "+", "i"}], ",", "j"}], "]"}], "+", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "j"}]}], "]"}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{"i", ",", "j"}], "]"}]}], "+", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{"i", ",", 
      RowBox[{"2", "+", "j"}]}], "]"}], "+", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"2", "+", "i"}], ",", "j"}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.908559896017933*^9, 3.908559901559376*^9}, 
   3.908559940118788*^9, 3.908561009035441*^9, 3.9085612500757523`*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"7921a52a-59ed-43f9-90e8-563aed515a20"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"periodic", " ", "bc"}], "*)"}]], "Input",
 CellChangeTimes->{{3.908557579769444*^9, 3.908557588730476*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"b9c58228-baa9-4a82-b016-c3d60a40a550"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sublim", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", 
      RowBox[{"n_", ",", "k_"}], "]"}], "->", 
     RowBox[{"\[Phi]", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "nn"}], "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "nn"}], "]"}], "+", "1"}]}], "]"}]}], 
    ",", 
    RowBox[{
     RowBox[{"\[Pi]", "[", 
      RowBox[{"n_", ",", "k_", ",", "l_"}], "]"}], "->", 
     RowBox[{"\[Pi]", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"n", "-", "1"}], ",", "nn"}], "]"}], "+", "1"}], ",", 
       RowBox[{
        RowBox[{"Mod", "[", 
         RowBox[{
          RowBox[{"k", "-", "1"}], ",", "nn"}], "]"}], "+", "1"}], ",", "l"}],
       "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.908530211705243*^9, 3.908530239214819*^9}, {
  3.9085305325873137`*^9, 3.908530542622369*^9}, {3.908530962154674*^9, 
  3.9085309966462717`*^9}, {3.908534244036254*^9, 3.908534257923827*^9}},
 CellLabel->
  "In[299]:=",ExpressionUUID->"04c90fae-a4e4-4b63-964e-368cbb5d956a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Phi]", "[", 
     RowBox[{"n_", ",", "k_"}], "]"}], "\[Rule]", 
    RowBox[{"\[Phi]", "[", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "5"}], "]"}]}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}], ",", "5"}], "]"}]}]}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"\[Pi]", "[", 
     RowBox[{"n_", ",", "k_", ",", "l_"}], "]"}], "\[Rule]", 
    RowBox[{"\[Pi]", "[", 
     RowBox[{
      RowBox[{"1", "+", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "n"}], ",", "5"}], "]"}]}], ",", 
      RowBox[{"1", "+", 
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}], ",", "5"}], "]"}]}], ",", "l"}], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.908530240866502*^9, 3.908530270032415*^9}, {
   3.908530347419229*^9, 3.908530362426928*^9}, 3.9085305430119457`*^9, 
   3.908530583895883*^9, 3.908530997129974*^9, 3.908531082363924*^9, 
   3.90853406100019*^9, 3.9085340917151012`*^9, 3.9085342587369967`*^9, 
   3.9085444422882347`*^9, 3.90854511179399*^9, 3.9085481470813*^9, 
   3.908548285344219*^9, 3.908548413735709*^9, 3.9085576216369333`*^9, 
   3.908557895782834*^9, 3.908557926000086*^9, 3.908559235058989*^9, {
   3.9085594368909063`*^9, 3.908559449543365*^9}, 3.908559576120289*^9, 
   3.9085599422491302`*^9, 3.9085610103579063`*^9, 3.9085611698221893`*^9, 
   3.90856125110467*^9, 3.9085614313376217`*^9},
 CellLabel->
  "Out[299]=",ExpressionUUID->"59063e63-fb29-4d1a-b736-e1bfb5e9c5a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dE\[Pi]", "=", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Pi]", "[", 
          RowBox[{"i", ",", "j", ",", "1"}], "]"}], 
         RowBox[{"d\[Pi]", "[", 
          RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Pi]", "[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}], 
         RowBox[{"d\[Pi]", "[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}]}]}], "/.", 
       RowBox[{"i", "->", "ip"}]}], "/.", 
      RowBox[{"j", "->", "jp"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"ip", ",", "1", ",", "nn"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"jp", ",", "1", ",", "nn"}], "}"}]}], "]"}], "/.", 
   "Sublim"}]}]], "Input",
 CellChangeTimes->{{3.908489889153554*^9, 3.908490037074236*^9}, {
   3.908490068703394*^9, 3.90849009530855*^9}, {3.9084902226413517`*^9, 
   3.9084902439910097`*^9}, {3.908528858973713*^9, 3.908528859878276*^9}, {
   3.9085300308907213`*^9, 3.908530046785574*^9}, {3.908530245981286*^9, 
   3.9085302533705263`*^9}, {3.908530318462575*^9, 3.908530318840228*^9}, {
   3.908530422279039*^9, 3.908530424041017*^9}, 3.9085306022320127`*^9, 
   3.908530723553973*^9, 3.908548293705652*^9, 3.9085576056946983`*^9},
 CellLabel->
  "In[300]:=",ExpressionUUID->"5666418b-79f3-4be7-8427-acea5c9aae9d"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{
       RowBox[{
         RowBox[{"\[Pi]", "[", 
           RowBox[{"2", ",", "1", ",", "2"}], "]"}], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{
               FractionBox["1", "4"], " ", 
               RowBox[{"\[Pi]", "[", 
                 RowBox[{"2", ",", "1", ",", "2"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "2", ",", "2"}], "]"}], "-", 
                   RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "5", ",", "2"}], "]"}]}], ")"}]}], "+", 
             
             RowBox[{
               FractionBox["1", "4"], " ", 
               RowBox[{"\[Pi]", "[", 
                 RowBox[{"2", ",", "1", ",", "1"}], "]"}], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"-", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}]}], "+", 
                   RowBox[{"\[Pi]", "[", 
                    RowBox[{"3", ",", "1", ",", "2"}], "]"}]}], ")"}]}], "+", 
             
             RowBox[{
               FractionBox["1", "2"], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "2", ",", "2"}], "]"}], "2"], "-", 
                    SuperscriptBox[
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "5", ",", "2"}], "]"}], "2"]}], ")"}]}],
                    "+", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}]}], " ", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"1", ",", "1", ",", "2"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"3", ",", "1", ",", "1"}], "]"}], " ", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"3", ",", "1", ",", "2"}], "]"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
             RowBox[{
               FractionBox["1", "2"], " ", "\[Delta]", " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "2"}], "]"}], "-", 
                   RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "5"}], "]"}]}], ")"}], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "2"}], "]"}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "4"}], "]"}], "-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "5"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "2"}], "]"}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "3"}], "]"}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "5"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "1"}], "]"}], "-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}], "-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "1"}], "]"}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"4", ",", "1"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "1"}], "]"}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"5", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
       TemplateBox[{"48"}, "OutputSizeLimit`Skeleton"], "+", 
       RowBox[{
         RowBox[{"\[Pi]", "[", 
           RowBox[{"5", ",", "4", ",", "2"}], "]"}], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{
               FractionBox["1", "4"], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{"\[Pi]", "[", 
                    RowBox[{"1", ",", "4", ",", "2"}], "]"}], "-", 
                   RowBox[{"\[Pi]", "[", 
                    RowBox[{"4", ",", "4", ",", "2"}], "]"}]}], ")"}], " ", 
               RowBox[{"\[Pi]", "[", 
                 RowBox[{"5", ",", "4", ",", "1"}], "]"}]}], "+", 
             TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "+", 
             TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "+", 
             RowBox[{
               FractionBox["1", "2"], " ", "\[Delta]", " ", 
               RowBox[{"(", 
                 TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ")"}], " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "4"}], "]"}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "4"}], "]"}], "-", 
                    RowBox[{"\[Phi]", "[", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], "]"}], 
                    "-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"5", ",", "4"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    FractionBox["1", "2"], " ", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]}]}], 
                    ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ")"}]}]}],
                  ")"}]}]}], ")"}]}]}], Short[#, 5]& ], "line" -> 300, 
   "sessionID" -> 33404645443525692709, "byteCount" -> 324448, "size" -> 5, 
   "stored" -> False, "expr" -> Missing["NotStored"], "wrap" -> 
   OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{
  3.908548422503674*^9, {3.90855760942964*^9, 3.9085576339748087`*^9}, {
   3.9085579040793552`*^9, 3.908557933475567*^9}, 3.908559238679967*^9, 
   3.90855945631732*^9, 3.9085595920139923`*^9, 3.908559958223392*^9, 
   3.908561026336282*^9, 3.9085611799447803`*^9, 3.908561256909295*^9, 
   3.908561437980637*^9},
 CellLabel->
  "Out[300]=",ExpressionUUID->"766c437f-956a-4c92-8f55-6c56f02d3412"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"just", " ", "\[Pi]", " ", "kinetic", " ", 
   RowBox[{"energy", " ", "--"}], " ", "cross", " ", "check"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.9085354756429663`*^9, 3.9085354865226316`*^9}, {
  3.908535742553541*^9, 3.9085357533487377`*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"6af307a7-109e-4210-bdd2-4e5390709aaa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dE\[Pi]", "/.", 
     RowBox[{"\[Gamma]", "->", "0"}]}], "/.", 
    RowBox[{"\[Delta]", "->", "0"}]}], "//", "Expand"}]}]], "Input",
 CellChangeTimes->{{3.908530277598577*^9, 3.908530289456086*^9}, {
   3.908530429060195*^9, 3.908530433790635*^9}, 3.9085576072832727`*^9, 
   3.90856101292099*^9},
 CellLabel->
  "In[301]:=",ExpressionUUID->"de5bb3ea-c29a-47be-9b19-1d7b3eadf2ff"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.908530290143417*^9, 3.908530328297862*^9, 3.908530369078662*^9, {
   3.908530430844075*^9, 3.908530434314495*^9}, 3.908530549899225*^9, 
   3.908531005011704*^9, 3.9085311092199993`*^9, 3.9085341265157824`*^9, 
   3.908534294985598*^9, 3.908544456374428*^9, 3.908545119891651*^9, 
   3.908548160358886*^9, 3.908548309532176*^9, 3.9085484226766768`*^9, 
   3.908556184015019*^9, 3.908557643940003*^9, {3.908557908273487*^9, 
   3.9085579336632566`*^9}, 3.9085592420587807`*^9, 3.9085594565114393`*^9, 
   3.908559592230001*^9, 3.908559958407259*^9, 3.9085610265526257`*^9, {
   3.908561419605926*^9, 3.908561438180827*^9}},
 CellLabel->
  "Out[301]=",ExpressionUUID->"2cd4e0da-7be1-41c0-9c3d-dc209dc8c498"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gradd\[Phi]", "[", 
   RowBox[{"i_", ",", "j_", ",", "\[Mu]_"}], "]"}], ":=", 
  RowBox[{"del", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"del", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Pi]", "[", 
            RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], ",", "1"}], "]"}], 
        "+", 
        RowBox[{"del", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"i", ",", "j"}], "]"}], 
           RowBox[{"\[Pi]", "[", 
            RowBox[{"i", ",", "j", ",", "2"}], "]"}]}], ",", "2"}], "]"}]}], 
       ")"}], " ", "\[Alpha]"}], "+", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Pi]", "[", 
          RowBox[{"i", ",", "j", ",", "1"}], "]"}], " ", 
         RowBox[{"del", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"\[Pi]", "[", 
          RowBox[{"i", ",", "j", ",", "2"}], "]"}], " ", 
         RowBox[{"del", "[", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", "2"}], "]"}]}]}], ")"}], 
      "\[Beta]"}]}], ",", "\[Mu]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.908529040741127*^9, 3.908529158216631*^9}, {
  3.9085291918189697`*^9, 3.9085292351154823`*^9}, {3.908561443455017*^9, 
  3.908561444210476*^9}},
 CellLabel->
  "In[302]:=",ExpressionUUID->"5c16089b-03e1-4c8a-a9f6-c8cd723a8d11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"dE\[Phi]", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "1"}], "]"}], 
          RowBox[{"gradd\[Phi]", "[", 
           RowBox[{"i", ",", "j", ",", "1"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"del", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", 
             RowBox[{"i", ",", "j"}], "]"}], ",", "2"}], "]"}], 
          RowBox[{"gradd\[Phi]", "[", 
           RowBox[{"i", ",", "j", ",", "2"}], "]"}]}]}], "/.", 
        RowBox[{"i", "->", "ip"}]}], "/.", 
       RowBox[{"j", "->", "jp"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"ip", ",", "1", ",", "nn"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"jp", ",", "1", ",", "nn"}], "}"}]}], "]"}], "/.", 
    "Sublim"}]}]}]], "Input",
 CellChangeTimes->{{3.908529201575344*^9, 3.90852920686204*^9}, {
   3.90852923960054*^9, 3.908529243192514*^9}, {3.908529735027112*^9, 
   3.90852983061043*^9}, {3.908529889124584*^9, 3.908529940494073*^9}, 
   3.9085302060031157`*^9, {3.908530413077409*^9, 3.9085304163604097`*^9}, 
   3.908530476540106*^9, 3.908530604370933*^9, 3.9085307163366117`*^9, 
   3.908548313603506*^9, 3.908557609195937*^9, 3.908559580505095*^9},
 CellLabel->
  "In[303]:=",ExpressionUUID->"e9389f54-1777-4ce3-986f-6876080d3e4b"],

Cell[BoxData[
 TemplateBox[<|"shortenedBoxes" -> TagBox[
     RowBox[{
       RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{"-", 
               RowBox[{"\[Phi]", "[", 
                 RowBox[{"2", ",", "1"}], "]"}]}], "+", 
             RowBox[{"\[Phi]", "[", 
               RowBox[{"2", ",", "3"}], "]"}]}], ")"}], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{"\[Alpha]", " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}]}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "2", ",", "2"}], "]"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "3", ",", "2"}], "]"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "3"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "5", ",", "2"}], "]"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "5"}], "]"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"1", ",", "1", ",", "1"}], "]"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "1"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"1", ",", "2", ",", "1"}], "]"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "2"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"3", ",", "1", ",", "1"}], "]"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "1"}], "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"3", ",", "2", ",", "1"}], "]"}], " ", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "2"}], "]"}]}]}], ")"}]}]}], ")"}]}], 
             "+", 
             RowBox[{"\[Beta]", " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "2", ",", "2"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "3"}], "]"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "1", ",", "2"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "2"}], "]"}], "-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "5"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "1", ",", "1"}], "]"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "1"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "1"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "2", ",", "1"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "2"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "2"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
             RowBox[{"\[Alpha]", " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ")"}]}], 
                   "+", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ")"}]}]}],
                  ")"}]}], "+", 
             RowBox[{"\[Beta]", " ", 
               RowBox[{"(", 
                 RowBox[{
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "2", ",", "2"}], "]"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "1"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "3"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "3", ",", "2"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "2"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"2", ",", "4"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    FractionBox["1", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "2", ",", "1"}], "]"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "2"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "2"}], "]"}]}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"\[Pi]", "[", 
                    RowBox[{"2", ",", "3", ",", "1"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"1", ",", "3"}], "]"}]}], "+", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"3", ",", "3"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
       TemplateBox[{"48"}, "OutputSizeLimit`Skeleton"], "+", 
       RowBox[{
         FractionBox["1", "4"], " ", 
         RowBox[{"(", 
           RowBox[{
             RowBox[{"-", 
               RowBox[{"\[Phi]", "[", 
                 RowBox[{"5", ",", "3"}], "]"}]}], "+", 
             TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"]}], ")"}], " ", 
         RowBox[{"(", 
           TemplateBox[{"1"}, "OutputSizeLimit`Skeleton"], ")"}]}]}], 
     Short[#, 5]& ], "line" -> 303, "sessionID" -> 33404645443525692709, 
   "byteCount" -> 526048, "size" -> 5, "stored" -> False, "expr" -> 
   Missing["NotStored"], "wrap" -> OutputSizeLimit`Defer, "version" -> 1|>,
  "OutputSizeLimitTemplate"]], "Output",
 CellChangeTimes->{3.908548437826605*^9, 3.908556214187305*^9, 
  3.908557695210599*^9, 3.9085579769617662`*^9, 3.908559250749907*^9, 
  3.9085594736757393`*^9, 3.908559611658936*^9, 3.9085599837114553`*^9, 
  3.908561045076713*^9, 3.908561197476286*^9, 3.908561275159485*^9, 
  3.9085614649979677`*^9},
 CellLabel->
  "Out[303]=",ExpressionUUID->"63d3cf92-6841-4259-838c-5aea8527e995"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"test", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dE\[Phi]", "+", "dE\[Pi]"}], "/.", 
          RowBox[{
           RowBox[{"\[Phi]", "[", 
            RowBox[{"i_", ",", "j_"}], "]"}], "->", 
           RowBox[{"(", 
            RowBox[{"i", "+", "j"}], ")"}]}]}], "/.", 
         RowBox[{"\[Beta]", "->", "1"}]}], "/.", 
        RowBox[{"\[Alpha]", "->", "0"}]}], "/.", 
       RowBox[{"\[Delta]", "->", "1"}]}], "//", "Expand"}], ",", 
     RowBox[{"\[Pi]", "[", 
      RowBox[{"_", ",", "_", ",", "_"}], "]"}], ",", "Simplify"}], "]"}]}],
  Background->RGBColor[0.94, 0.88, 0.94]]], "Input",
 CellChangeTimes->{{3.908544484807856*^9, 3.908544638819304*^9}, {
   3.908544849330422*^9, 3.908544860833098*^9}, {3.908544979270446*^9, 
   3.9085450694509497`*^9}, {3.908545178501774*^9, 3.9085451812198772`*^9}, {
   3.908548348080065*^9, 3.90854835740632*^9}, {3.908548445471333*^9, 
   3.908548446533883*^9}, {3.9085484991136513`*^9, 3.908548509539645*^9}, 
   3.9085546814858427`*^9, {3.9085547861046867`*^9, 3.908554791619874*^9}, {
   3.908556845178357*^9, 3.908556899115197*^9}, {3.908556941239555*^9, 
   3.908556947255953*^9}, {3.908557083187838*^9, 3.9085570877301693`*^9}, {
   3.908557611483781*^9, 3.90855761267651*^9}, {3.908557743328437*^9, 
   3.908557744255692*^9}, {3.908558034856228*^9, 3.908558091053052*^9}, {
   3.908559001537566*^9, 3.908559020119361*^9}, {3.908559527963421*^9, 
   3.908559529898381*^9}, {3.908560011167585*^9, 3.908560094908092*^9}, {
   3.9085614539645853`*^9, 3.908561462321875*^9}},
 CellLabel->
  "In[304]:=",ExpressionUUID->"e1f06eaa-64d0-44a2-9d95-ebe02e85e8c9"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.9085444922579317`*^9, 3.908544640056205*^9}, 
   3.908544864514666*^9, {3.908544987927413*^9, 3.908545069904573*^9}, 
   3.908545132285713*^9, 3.9085451824003267`*^9, 3.9085483581399183`*^9, {
   3.908548442434464*^9, 3.908548447392148*^9}, {3.908548499579858*^9, 
   3.90854851000078*^9}, {3.908554681987499*^9, 3.908554698149497*^9}, {
   3.90855478710995*^9, 3.908554792828946*^9}, 3.9085562152263536`*^9, {
   3.9085568582933273`*^9, 3.908556899746122*^9}, {3.908556944018791*^9, 
   3.908556947897057*^9}, 3.908557088744238*^9, 3.908557695488206*^9, 
   3.908557744984956*^9, 3.90855798281708*^9, {3.908558048974305*^9, 
   3.908558091786737*^9}, {3.908559011265257*^9, 3.908559020785285*^9}, 
   3.9085592508559113`*^9, {3.9085595245422*^9, 3.908559530382161*^9}, {
   3.908559611922985*^9, 3.9085596225869637`*^9}, {3.908559983954693*^9, 
   3.908560095665944*^9}, 3.908561045355887*^9, {3.90856119769177*^9, 
   3.908561201001939*^9}, 3.908561275401771*^9, 3.908561465180105*^9},
 CellLabel->
  "Out[304]=",ExpressionUUID->"c9071c98-ef48-4f0a-9249-920fff909725"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonSolen", "[", "e_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Expand", "[", 
    RowBox[{
     RowBox[{"e", "/.", 
      RowBox[{
       RowBox[{"\[Pi]", "[", 
        RowBox[{"i_", ",", "j_", ",", "2"}], "]"}], "->", 
       RowBox[{
        RowBox[{"\[Pi]", "[", 
         RowBox[{
          RowBox[{"i", "+", "1"}], ",", 
          RowBox[{"j", "+", "1"}], ",", "1"}], "]"}], "-", 
        RowBox[{"\[Pi]", "[", 
         RowBox[{
          RowBox[{"i", "-", "1"}], ",", 
          RowBox[{"j", "+", "1"}], ",", "1"}], "]"}], "+", 
        RowBox[{"\[Pi]", "[", 
         RowBox[{"i", ",", 
          RowBox[{"j", "+", "2"}], ",", "2"}], "]"}]}]}]}], "/.", "Sublim"}], 
    "]"}], "//", "Simplify"}]}]], "Input",
 CellLabel->
  "In[293]:=",ExpressionUUID->"1556d23d-d64c-42d8-94a8-aa85512a5e39"]
},
WindowSize->{2520, 1387},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X x86 (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bf12b76c-5efb-4a90-a89b-da73d00738c2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 688, 11, 46, "Input",ExpressionUUID->"00a18cbb-b83a-45f5-be50-52b98b5e24a7"],
Cell[1271, 35, 411, 7, 52, "Output",ExpressionUUID->"3a67b46b-9bba-491f-b778-56341db0b9bc"]
}, Open  ]],
Cell[1697, 45, 932, 30, 78, "Input",ExpressionUUID->"f2a3c3e1-83fc-40eb-b54b-efde4add3ac0"],
Cell[2632, 77, 233, 5, 46, "Input",ExpressionUUID->"45f6a5d4-3516-41fa-83c1-6ab6f6778175"],
Cell[CellGroupData[{
Cell[2890, 86, 425, 12, 46, "Input",ExpressionUUID->"bcbe3be1-ea50-4f1f-bb9f-a643fa13f755"],
Cell[3318, 100, 666, 19, 69, "Output",ExpressionUUID->"f352d340-1f96-44db-982a-a12aeafc59a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4021, 124, 658, 19, 46, "Input",ExpressionUUID->"199d784e-e5f6-47e2-a3de-aa9f199ee794"],
Cell[4682, 145, 1031, 30, 70, "Output",ExpressionUUID->"c4122b34-a387-43db-8854-54bee0ae2aae"]
}, Open  ]],
Cell[5728, 178, 5237, 150, 109, "Input",ExpressionUUID->"d31b926c-3ab9-4e5f-91bd-cd4088b339cb"],
Cell[10968, 330, 205, 4, 46, "Input",ExpressionUUID->"cdc4df2a-145b-4778-bea8-35e81442c140"],
Cell[CellGroupData[{
Cell[11198, 338, 604, 19, 46, "Input",ExpressionUUID->"179c6bbc-3f6c-4e49-9b48-e0031092dfe8"],
Cell[11805, 359, 855, 25, 69, "Output",ExpressionUUID->"7921a52a-59ed-43f9-90e8-563aed515a20"]
}, Open  ]],
Cell[12675, 387, 231, 5, 46, "Input",ExpressionUUID->"b9c58228-baa9-4a82-b016-c3d60a40a550"],
Cell[CellGroupData[{
Cell[12931, 396, 1241, 36, 46, "Input",ExpressionUUID->"04c90fae-a4e4-4b63-964e-368cbb5d956a"],
Cell[14175, 434, 1770, 45, 52, "Output",ExpressionUUID->"59063e63-fb29-4d1a-b736-e1bfb5e9c5a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15982, 484, 1390, 33, 46, "Input",ExpressionUUID->"5666418b-79f3-4be7-8427-acea5c9aae9d"],
Cell[17375, 519, 8491, 193, 209, "Output",ExpressionUUID->"766c437f-956a-4c92-8f55-6c56f02d3412"]
}, Open  ]],
Cell[25881, 715, 372, 8, 46, "Input",ExpressionUUID->"6af307a7-109e-4210-bdd2-4e5390709aaa"],
Cell[CellGroupData[{
Cell[26278, 727, 463, 11, 78, "Input",ExpressionUUID->"de5bb3ea-c29a-47be-9b19-1d7b3eadf2ff"],
Cell[26744, 740, 758, 12, 52, "Output",ExpressionUUID->"2cd4e0da-7be1-41c0-9c3d-dc209dc8c498"]
}, Open  ]],
Cell[27517, 755, 1668, 48, 46, "Input",ExpressionUUID->"5c16089b-03e1-4c8a-a9f6-c8cd723a8d11"],
Cell[CellGroupData[{
Cell[29210, 807, 1506, 37, 78, "Input",ExpressionUUID->"e9389f54-1777-4ce3-986f-6876080d3e4b"],
Cell[30719, 846, 9034, 207, 209, "Output",ExpressionUUID->"63d3cf92-6841-4259-838c-5aea8527e995"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39790, 1058, 1747, 36, 46, "Input",ExpressionUUID->"e1f06eaa-64d0-44a2-9d95-ebe02e85e8c9"],
Cell[41540, 1096, 1121, 16, 52, "Output",ExpressionUUID->"c9071c98-ef48-4f0a-9249-920fff909725"]
}, Open  ]],
Cell[42676, 1115, 830, 24, 46, "Input",ExpressionUUID->"1556d23d-d64c-42d8-94a8-aa85512a5e39"]
}
]
*)

